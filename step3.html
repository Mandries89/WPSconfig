<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project Configuration Form - Step 3</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <div class="header-left">
                <div class="info-box">In te vullen door de klant</div>
                <div class="info-box">In te vullen door WPS</div>
            </div>
            <div class="header-center">
                <img src="logo.png" alt="WPS Logo" class="logo">
            </div>
            <div class="header-right"></div>
        </header>

        <h2>Summary from Step 2</h2>
        <table id="summaryTable">
            <tr>
                <th>Total</th>
                <th>Entry</th>
                <th>Exit</th>
                <th>POF</th>
                <th>DOOR</th>
                <th>GATE</th>
                <th>Cashless</th>
                <th>SCANNER</th>
                <th>Counters</th>
            </tr>
            <tr>
                <td id="totalSpaces">0</td>
                <td id="totalEntry">0</td>
                <td id="totalExit">0</td>
                <td id="totalPOF">0</td>
                <td id="totalDOOR">0</td>
                <td id="totalGATE">0</td>
                <td id="totalCashless">0</td>
                <td id="totalSCANNER">0</td>
                <td id="totalCounters">0</td>
            </tr>
        </table>

        <h2>Station Configuration by Section</h2>
        <div id="stationsContainer"></div>

        <form id="step3Form" name="configFormStep3" method="POST" data-netlify="true" onsubmit="handleSubmit(event)">
            <input type="hidden" name="form-name" value="configFormStep3">

            <!-- Other form fields for Step 3 -->
            <!-- Placeholder for additional fields -->

            <input type="submit" value="Submit">
        </form>
        <button class="back-button" onclick="goBack()">Back</button>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', (event) => {
            // Retrieve and display totals from sessionStorage
            document.getElementById('totalSpaces').innerText = sessionStorage.getItem('totalSpaces');
            document.getElementById('totalEntry').innerText = sessionStorage.getItem('totalEntry');
            document.getElementById('totalExit').innerText = sessionStorage.getItem('totalExit');
            document.getElementById('totalPOF').innerText = sessionStorage.getItem('totalPOF');
            document.getElementById('totalDOOR').innerText = sessionStorage.getItem('totalDOOR');
            document.getElementById('totalGATE').innerText = sessionStorage.getItem('totalGATE');
            document.getElementById('totalCashless').innerText = sessionStorage.getItem('totalCashless');
            document.getElementById('totalSCANNER').innerText = sessionStorage.getItem('totalSCANNER');
            document.getElementById('totalCounters').innerText = sessionStorage.getItem('totalCounters');

            generateStationsBySection();
        });

        function generateStationsBySection() {
            const totalEntry = parseInt(sessionStorage.getItem('totalEntry'));
            const totalExit = parseInt(sessionStorage.getItem('totalExit'));
            const stationsContainer = document.getElementById('stationsContainer');
            stationsContainer.innerHTML = '';  // Clear previous stations

            // Assuming we have the number of sections stored in sessionStorage
            const numSections = sessionStorage.getItem('numSections');
            if (!numSections) {
                alert('No section information available from Step 2.');
                return;
            }

            const createTableForSection = (sectionIndex) => {
                const table = document.createElement('table');
                const headerRow = document.createElement('tr');
                headerRow.innerHTML = `
                    <th>Station</th>
                    <th>Name</th>
                    <th>Section</th>
                    <th>ANPR</th>
                    <th>Audio support</th>
                    <th>Ticketprinter</th>
                    <th>Credit card in</th>
                    <th>Bancontact / CC</th>
                    <th>Cash</th>
                `;
                table.appendChild(headerRow);

                const entryCount = totalEntry / numSections;
                const exitCount = totalExit / numSections;

                for (let i = 1; i <= entryCount; i++) {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>Entry ${i}</td>
                        <td><input type="text" name="section${sectionIndex}Entry${i}Name" required></td>
                        <td><input type="text" name="section${sectionIndex}Entry${i}Section" value="carpark${sectionIndex}" required></td>
                        <td>
                            <select name="section${sectionIndex}Entry${i}ANPR">
                                <option value="Yes">Yes</option>
                                <option value="No" selected>No</option>
                            </select>
                        </td>
                        <td>
                            <select name="section${sectionIndex}Entry${i}AudioSupport">
                                <option value="Yes">Yes</option>
                                <option value="No" selected>No</option>
                            </select>
                        </td>
                        <td>
                            <select name="section${sectionIndex}Entry${i}TicketPrinter">
                                <option value="Yes">Yes</option>
                                <option value="No" selected>No</option>
                            </select>
                        </td>
                        <td>
                            <select name="section${sectionIndex}Entry${i}CreditCardIn">
                                <option value="Yes">Yes</option>
                                <option value="No" selected>No</option>
                            </select>
                        </td>
                        <td>
                            <select name="section${sectionIndex}Entry${i}BancontactCC">
                                <option value="Yes">Yes</option>
                                <option value="No" selected>No</option>
                            </select>
                        </td>
                        <td>
                            <select name="section${sectionIndex}Entry${i}Cash">
                                <option value="Yes">Yes</option>
                                <option value="No" selected>No</option>
                            </select>
                        </td>
                    `;
                    table.appendChild(row);
                }

                for (let i = 1; i <= exitCount; i++) {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>Exit ${i}</td>
                        <td><input type="text" name="section${sectionIndex}Exit${i}Name" required></td>
                        <td><input type="text" name="section${sectionIndex}Exit${i}Section" value="carpark${sectionIndex}" required></td>
                        <td>
                            <select name="section${sectionIndex}Exit${i}ANPR">
                                <option value="Yes">Yes</option>
                                <option value="No" selected>No</option>
                            </select>
                        </td>
                        <td>
                            <select name="section${sectionIndex}Exit${i}AudioSupport">
                                <option value="Yes">Yes</option>
                                <option value="No" selected>No</option>
                            </select>
                        </td>
                        <td>
                            <select name="section${sectionIndex}Exit${i}TicketPrinter">
                                <option value="Yes">Yes</option>
                                <option value="No" selected>No</option>
                            </select>
                        </td>
                        <td>
                            <select name="section${sectionIndex}Exit${i}CreditCardIn">
                                <option value="Yes">Yes</option>
                                <option value="No" selected>No</option>
                            </select>
                        </td>
                        <td>
                            <select name="section${sectionIndex}Exit${i}BancontactCC">
                                <option value="Yes">Yes</option>
                                <option value="No" selected>No</option>
                            </select>
                        </td>
                        <td>
                            <select name="section${sectionIndex}Exit${i}Cash">
                                <option value="Yes">Yes</option>
                                <option value="No" selected>No</option>
                            </select>
                        </td>
                    `;
                    table.appendChild(row);
                }

                // Additional stations (POF, etc.) can be added similarly

                return table;
            };

            for (let i = 1; i <= numSections; i++) {
                const sectionHeader = document.createElement('h3');
                sectionHeader.innerText = `Section ${i}`;
                stationsContainer.appendChild(sectionHeader);
                stationsContainer.appendChild(createTableForSection(i));
            }
        }

        function handleSubmit(event) {
            event.preventDefault();
            // Process and submit the form data
            const formData = new FormData(event.target);
            for (let [key, value] of formData.entries()) {
                sessionStorage.setItem(key, value);
            }
            event.target.submit();
        }

        function goBack() {
            window.location.href = "step2.html";
        }
    </script>
</body>
</html>
